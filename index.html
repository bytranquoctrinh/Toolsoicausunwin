
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Tool Soi Cầu Sunwin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #000;
      overflow: hidden;
      font-family: monospace;
      color: #00ffcc;
    }

    #particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }

    .container {
      z-index: 1;
      position: relative;
      max-width: 380px;
      margin: 30px auto;
      padding: 16px;
      background: rgba(0, 255, 204, 0.07);
      border: 1px solid #00ffcc33;
      box-shadow: 0 0 15px #00ffcc55;
      border-radius: 8px;
      animation: fadeIn 1.2s ease-out;
    }

    @keyframes fadeIn {
      0% { opacity: 0; transform: scale(0.96); }
      100% { opacity: 1; transform: scale(1); }
    }

    h1 {
      text-align: center;
      font-size: 16px;
      margin-bottom: 10px;
      color: #00ffff;
      text-shadow: 0 0 12px #00ffff;
      animation: flicker 2.5s infinite alternate;
    }

    @keyframes flicker {
      0% { opacity: 0.8; }
      50% { opacity: 1; text-shadow: 0 0 15px #00ffff, 0 0 25px #00ffff; }
      100% { opacity: 0.85; }
    }

    textarea, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      background: #000;
      color: #00ffcc;
      border: 1px solid #00ffff99;
      border-radius: 5px;
      font-size: 14px;
      box-shadow: 0 0 10px #00ffff33;
      transition: all 0.3s ease;
    }

    textarea:focus {
      outline: none;
      box-shadow: 0 0 15px #00ffff88;
    }

    button:hover {
      background: #00ffff;
      color: #000;
      transform: scale(1.03);
      box-shadow: 0 0 20px #00ffff99;
    }

    .output {
      margin-top: 12px;
      padding: 10px;
      background: rgba(0,255,204,0.05);
      border-left: 2px solid #00ffcc88;
      font-size: 13px;
      line-height: 1.4;
      animation: fadeIn 0.5s ease;
    }
  </style>
</head>
<body>
<canvas id="particles"></canvas>

<div class="container">
  <h1>TOOL SOI CẦU - Sunwin</h1>
  <textarea id="input" placeholder="Nhập chuỗi T/X..."></textarea>
  <button onclick="analyze()">Phân Tích</button>
  <div class="output" id="output"></div>
</div>

<script>
// Particle setup
const canvas = document.getElementById("particles");
const ctx = canvas.getContext("2d");
let particles = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

function createParticle() {
  return {
    x: Math.random() * canvas.width,
    y: canvas.height + Math.random() * 20,
    size: Math.random() * 2 + 1,
    speedY: Math.random() * 1.2 + 0.6,
    opacity: Math.random() * 0.8 + 0.2
  };
}

function updateParticles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  for (let p of particles) {
    p.y -= p.speedY;
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.size, 0, 2 * Math.PI);
    ctx.fillStyle = `rgba(0,255,255,${p.opacity})`;
    ctx.fill();
  }
  particles = particles.filter(p => p.y > -10);
  while (particles.length < 240) {
    particles.push(createParticle());
  }
  requestAnimationFrame(updateParticles);
}

window.addEventListener('load', () => {
  setTimeout(() => {
    for (let i = 0; i < 240; i++) particles.push(createParticle());
    updateParticles();
  }, 50);
});

// Analyze logic
function analyze() {
  const input = document.getElementById("input").value.toUpperCase().replace(/[^TX]/g, "");
  const output = document.getElementById("output");

  if (input.length < 10) {
    output.innerHTML = "<b style='color:red'>Nhập ít nhất 10 ký tự T/X.</b>";
    return;
  }

  output.innerHTML = "<i>Đang phân tích cầu...</i>";

  setTimeout(() => {
    const seq = input.split("");
    const predictions = [];
    let totalT = 0, totalX = 0, switchCount = 0;
    let longestT = 0, longestX = 0;
    let doubleT = 0, doubleX = 0;
    let current = seq[0], count = 1;

    for (let i = 1; i < seq.length; i++) {
      if (seq[i] === seq[i - 1]) {
        count++;
      } else {
        if (current === "T") {
          if (count === 2) doubleT++;
          if (count > longestT) longestT = count;
        } else {
          if (count === 2) doubleX++;
          if (count > longestX) longestX = count;
        }
        switchCount++;
        current = seq[i];
        count = 1;
      }
    }

    if (current === "T") {
      if (count === 2) doubleT++;
      if (count > longestT) longestT = count;
    } else {
      if (count === 2) doubleX++;
      if (count > longestX) longestX = count;
    }

    totalT = seq.filter(x => x === "T").length;
    totalX = seq.filter(x => x === "X").length;

    for (let i = 3; i < seq.length; i++) {
      const last3 = seq.slice(i - 3, i);
      let predict = "X";
      if (last3.every(v => v === last3[0])) {
        predict = last3[0];
      } else if (last3[1] === last3[2]) {
        predict = last3[1] === "T" ? "X" : "T";
      } else {
        predict = last3[2] === "T" ? "X" : "T";
      }
      predictions.push({ real: seq[i], predict });
    }

    const correct = predictions.filter(p => p.real === p.predict).length;
    const accuracy = Math.round((correct / predictions.length) * 100);
    let finalPredict = predictions.at(-1).predict;
    let logicSwapped = false;

    if (accuracy < 40) {
      logicSwapped = true;
      finalPredict = finalPredict === "T" ? "X" : "T";
    }
    const swappedAccuracy = 100 - accuracy;

    output.innerHTML = `
      <b>Thống kê:</b><br>
      Tổng: ${seq.length} | <b>Tài:</b> ${totalT} | <b>Xỉu:</b> ${totalX}<br>
      Đổi bên: ${switchCount} | Bệt T/X: ${longestT}/${longestX} | Đúp T/X: ${doubleT}/${doubleX}<br><br>
      Độ chính xác logic gốc: <b>${accuracy}%</b><br>
      ${logicSwapped ? `<b style='color:yellow'>Logic yếu → Đã đảo!<br>Chính xác sau đảo: ${swappedAccuracy}%</b><br>` : ``}
      <br><b>Dự đoán tiếp theo:</b> <span style='font-size:1.2em'>${finalPredict}</span>
    `;
  }, 1000);
}
</script>
</body>
</html>
